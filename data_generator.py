import numpy as np
import random
import string
import statistics

import encryptors.vigenere
import encryptors.substitution
import encryptors.transposition
import encryptors.hill
import encryptors.twosquare

config = {"vigenere": 0,
              "substitution": 1,
              "transposition": 2,
              "hill 2x2": 3,
              "hill 3x3": 4,
              "twosquare": 5

        }


reverse_config = {v:k for k,v in config.items()}

def generate_data(count, data_file, label_file):

    data = []
    labels = []

    pts = [list('TOSHERLOCKHOLMESSHEISALWAYSTHEWOMANIHAVESELDOMHEARDHIMMENTIONHERUNDERANYOTHERNAMEINHISEYESSHEECLIPSESANDPREDOMINATESTHEWHOLEOFHERSEXITWASNOTTHATHEFELTANYEMOTIONAKINTOLOVEFORIRENEADLERALLEMOTIONSANDTHATONEPARTICULARLYWEREABHORRENTTOHISCOLDPRECISEBUTADMIRABLYBALANCEDMINDHEWASITAKEITTHEMOSTPERFECTREASONINGANDOBSERVINGMACHINETHATTHEWORLDHASSEENBUTASALOVERHEWOULDHAVEPLACEDHIMSELFINAFALSEPOSITIONHENEVERSPOKEOFTHESOFTERPASSIONSSAVEWITHAGIBEANDASNEERTHEYWEREADMIRABLETHINGSFORTHEOBSERVEREXCELLENTFORDRAWINGTHEVEILFROMMENSMOTIVESANDACTIONSBUTFORTHETRAINEDREASONERTOADMITSUCHINTRUSIONSINTOHISOWNDELICATEANDFINELYADJUSTEDTEMPERAMENTWASTOINTRODUCEADISTRACTINGFACTORWHICHMIGHTTHROWADOUBTUPONALLHISMENTALRESULTSGRITINASENSITIVEINSTRUMENTORACRACKINONEOFHISOWNHIGHPOWERLENSESWOULDNOTBEMOREDISTURBINGTHANASTRONGEMOTIONINANATURESUCHASHISANDYETTHEREWASBUTONEWOMANTOHIMANDTHATWOMANWASTHELATEIRENEADLEROFDUBIOUSANDQUESTIONABLEMEMORYIHADSEENLITTLEOFHOLMESLATELYMYMARRIAGEHADDRIFTEDUSAWAYFROMEACHOTHERMYOWNCOMPLETEHAPPINESSANDTHEHOMECENTREDINTERESTSWHICHRISEUPAROUNDTHEMANWHOFIRSTFINDSHIMSELFMASTEROFHISOWNESTABLISHMENTWERESUFFICIENTTOABSORBALLMYATTENTIONWHILEHOLMESWHOLOATHEDEVERYFORMOFSOCIETYWITHHISWHOLEBOHEMIANSOULREMAINEDINOURLODGINGSINBAKERSTREETBURIEDAMONGHISOLDBOOKSANDALTERNATINGFROMWEEKTOWEEKBETWEENCOCAINEANDAMBITIONTHEDROWSINESSOFTHEDRUGANDTHEFIERCEENERGYOFHISOWNKEENNATUREHEWASSTILLASEVERDEEPLYATTRACTEDBYTHESTUDYOFCRIMEANDOCCUPIEDHISIMMENSEFACULTIESANDEXTRAORDINARYPOWERSOFOBSERVATIONINFOLLOWINGOUTTHOSECLUESANDCLEARINGUPTHOSEMYSTERIESWHICHHADBEENABANDONEDASHOPELESSBYTHEOFFICIALPOLICEFROMTIMETOTIMEIHEARDSOMEVAGUEACCOUNTOFHISDOINGSOFHISSUMMONSTOODESSAINTHECASEOFTHETREPOFFMURDEROFHISCLEARINGUPOFTHESINGULARTRAGEDYOFTHEATKINSONBROTHERSATTRINCOMALEEANDFINALLYOFTHEMISSIONWHICHHEHADACCOMPLISHEDSODELICATELYANDSUCCESSFULLYFORTHEREIGNINGFAMILYOFHOLLANDBEYONDTHESESIGNSOFHISACTIVITYHOWEVERWHICHIMERELYSHAREDWITHALLTHEREADERSOFTHEDAILYPRESSIKNEWLITTLEOFMYFORMERFRIENDANDCOMPANIONONENIGHTITWASONTHETWENTIETHOFMARCHIWASRETURNINGFROMAJOURNEYTOAPATIENTFORIHADNOWRETURNEDTOCIVILPRACTICEWHENMYWAYLEDMETHROUGHBAKERSTREETASIPASSEDTHEWELLREMEMBEREDDOORWHICHMUSTALWAYSBEASSOCIATEDINMYMINDWITHMYWOOINGANDWITHTHEDARKINCIDENTSOFTHESTUDYINSCARLETIWASSEIZEDWITHAKEENDESIRETOSEEHOLMESAGAINANDTOKNOWHOWHEWASEMPLOYINGHISEXTRAORDINARYPOWERSHISROOMSWEREBRILLIANTLYLITANDEVENASILOOKEDUPISAWHISTALLSPAREFIGUREPASSTWICEINADARKSILHOUETTEAGAINSTTHEBLINDHEWASPACINGTHEROOMSWIFTLYEAGERLYWITHHISHEADSUNKUPONHISCHESTANDHISHANDSCLASPEDBEHINDHIMTOMEWHOKNEWHISEVERYMOODANDHABITHISATTITUDEANDMANNERTOLDTHEIROWNSTORYHEWASATWORKAGAINHEHADRISENOUTOFHISDRUGCREATEDDREAMSANDWASHOTUPONTHESCENTOFSOMENEWPROBLEMIRANGTHEBELLANDWASSHOWNUPTOTHECHAMBERWHICHHADFORMERLYBEENINPARTMYOWNHISMANNERWASNOTEFFUSIVEITSELDOMWASBUTHEWASGLADITHINKTOSEEMEWITHHARDLYAWORDSPOKENBUTWITHAKINDLYEYEHEWAVEDMETOANARMCHAIRTHREWACROSSHISCASEOFCIGARSANDINDICATEDASPIRITCASEANDAGASOGENEINTHECORNERTHENHESTOODBEFORETHEFIREANDLOOKEDMEOVERINHISSINGULARINTROSPECTIVEFASHION'),
           list('THECHARACTEROFTHELOYALISTSWHENGENERALHOWEEVACUATEDBOSTONMORETHANATHOUSANDPEOPLEFLEDWITHHIMTHISGREATCOMPANYACCORDINGTOACAREFULHISTORIANFORMEDTHEARISTOCRACYOFTHEPROVINCEBYVIRTUEOFTHEIROFFICIALRANKOFTHEIRDIGNIFIEDCALLINGSANDPROFESSIONSOFTHEIRHEREDITARYWEALTHANDOFTHEIRCULTURETHEACTOFBANISHMENTPASSEDBYMASSACHUSETTSINLISTINGOVERTORIESREADSLIKETHESOCIALREGISTEROFTHEOLDESTANDNOBLESTFAMILIESOFNEWENGLANDMORETHANONEOUTOFFIVEBEINGGRADUATESOFHARVARDCOLLEGETHESAMEWASTRUEOFNEWYORKANDPHILADELPHIANAMELYTHATTHELEADINGLOYALISTSWEREPROMINENTOFFICIALSOFTHEOLDORDERCLERGYMENANDWEALTHYMERCHANTSWITHPASSIONTHELOYALISTSFOUGHTAGAINSTTHEINEVITABLEORWITHANGUISHOFHEARTTHEYLEFTASREFUGEESFORALIFEOFUNCERTAINTYINCANADAORTHEMOTHERCOUNTRYTORIESASSAILTHEPATRIOTSTHETORIESWHOREMAINEDINAMERICAJOINEDTHEBRITISHARMYBYTHETHOUSANDSORINOTHERWAYSAIDEDTHEROYALCAUSETHOSEWHOWERESKILLFULWITHTHEPENASSAILEDTHEPATRIOTSINEDITORIALSRHYMESSATIRESANDPOLITICALCATECHISMSTHEYDECLAREDTHATTHEMEMBERSOFCONGRESSWEREOBSCUREPETTIFOGGINGATTORNEYSBANKRUPTSHOPKEEPERSOUTLAWEDSMUGGLERSETCTHEPEOPLEANDTHEIRLEADERSTHEYCHARACTERIZEDASWRETCHEDBANDITTITHEREFUSEANDDREGSOFMANKINDTHEGENERALSINTHEARMYTHEYSNEEREDATASMENOFRANKANDHONORNEARLYONAPARWITHTHOSEOFTHECONGRESSPATRIOTWRITERSAROUSETHENATIONALSPIRITSTUNGBYTORYTAUNTSPATRIOTWRITERSDEVOTEDTHEMSELVESTOCREATINGANDSUSTAININGAPUBLICOPINIONFAVORABLETOTHEAMERICANCAUSEMOREOVERTHEYHADTOCOMBATTHEDEPRESSIONTHATGREWOUTOFTHEMISFORTUNESINTHEEARLYDAYSOFTHEWARATERRIBLEDISASTERBEFELLGENERALSARNOLDANDMONTGOMERYINTHEWINTEROFASTHEYATTEMPTEDTOBRINGCANADAINTOTHEREVOLUTIONADISASTERTHATCOSTMENREPEATEDCALAMITIESHARASSEDWASHINGTONINASHEWASDEFEATEDONLONGISLANDDRIVENOUTOFNEWYORKCITYANDBEATENATHARLEMHEIGHTSANDWHITEPLAINSTHESEREVERSESWEREALMOSTTOOGREATFORTHESTOUTESTPATRIOTSPAMPHLETEERSPREACHERSANDPUBLICISTSROSEHOWEVERTOMEETTHENEEDSOFTHEHOURJOHNWITHERSPOONPROVOSTOFTHECOLLEGEOFNEWJERSEYFORSOOKTHECLASSROOMFORTHEFIELDOFPOLITICALCONTROVERSYTHEPOETPHILIPFRENEAUFLUNGTAUNTSOFCOWARDICEATTHETORIESANDCELEBRATEDTHESPIRITOFLIBERTYINMANYASTIRRINGPOEMSONGSBALLADSPLAYSANDSATIRESFLOWEDFROMTHEPRESSINANUNENDINGSTREAMFASTDAYSBATTLEANNIVERSARIESCELEBRATIONSOFIMPORTANTSTEPSTAKENBYCONGRESSAFFORDEDTOPATRIOTICCLERGYMENABUNDANTOPPORTUNITIESFORSERMONSDOESMRWIBERDPREACHAGAINSTOPPRESSIONANXIOUSLYINQUIREDJOHNADAMSINALETTERTOHISWIFETHEANSWERWASDECISIVETHECLERGYOFEVERYDENOMINATIONNOTEXCEPTINGTHEEPISCOPALIANTHUNDERANDLIGHTENEVERYSABBATHTHEYPRAYFORBOSTONANDMASSACHUSETTSTHEYTHANKGODMOSTEXPLICITLYANDFERVENTLYFOROURREMARKABLESUCCESSESTHEYPRAYFORTHEAMERICANARMYTHOMASPAINENEVERLETHISPENRESTHEHADBEENWITHTHEFORCESOFWASHINGTONWHENTHEYRETREATEDFROMFORTLEEANDWEREHARRIEDFROMNEWJERSEYINTOPENNSYLVANIAHEKNEWTHEEFFECTOFSUCHREVERSESONTHEARMYASWELLASONTHEPUBLICINDECEMBERHEMADEASECONDGREATAPPEALTOHISCOUNTRYMENINHISPAMPHLETTHECRISISTHEFIRSTPARTOFWHICHHEHADWRITTENWHILEDEFEATANDGLOOMWEREALLABOUTHIMTHISTRACTWASACRYFORCONTINUEDSUPPORTOFTHEREVOLUTIONTHESEARETHETIMESTHATTRYMENSSOULSHEOPENEDTHESUMMERSOLDIERANDTHESUNSHINEPATRIOTWILLINTHISCRISISSHRINKFROMTHESERVICEOFHISCOUNTRYBUTHETHATSTANDSITNOWDESERVESTHELOVEANDTHANKSOFMENANDWOMENPAINELAIDHISLASHFIERCELYONTHETORIESBRANDINGEVERYONEASACOWARDGROUNDEDINSERVILESLAVISHSELFINTERESTEDFEARHEDEPLOREDTHEINADEQUACYOFTHEMILITIAANDCALLEDFORAREALARMYHEREFUTEDTHECHARGETHATTHERETREATTHROUGHNEWJERSEYWASADISASTERANDHEPROMISEDVICTORYSOONBYPERSEVERANCEANDFORTITUDEHECONCLUDEDWEHAVETHEPROSPECTOFAGLORIOUSISSUEBYCOWARDICEANDSUBMISSIONTHESADCHOICEOFAVARIETYOFEVILSARAVAGEDCOUNTRYADEPOPULATEDCITYHABITATIONSWITHOUTSAFETYANDSLAVERYWITHOUTHOPELOOKONTHISPICTUREANDWEEPOVERITHISRINGINGCALLTOARMSWASFOLLOWEDBYANOTHERANDANOTHERUNTILTHELONGCONTESTWAS'),
           list('NORDIDTHEBRILLIANTEXPLOITSOFJOHNPAULJONESANDCAPTAINJOHNBARRYMATERIALLYCHANGETHESITUATIONTHEYDEMONSTRATEDTHESKILLOFAMERICANSEAMENANDTHEIRCOURAGEASFIGHTINGMENTHEYRAISEDTHERATESOFBRITISHMARINEINSURANCEBUTTHEYDIDNOTDETHRONETHEMISTRESSOFTHESEASLESSSPECTACULARANDMOREDISTINCTIVEWERETHEDEEDSOFTHEHUNDREDSOFPRIVATEERSANDMINORCAPTAINSWHOOVERHAULEDBRITISHSUPPLYSHIPSANDKEPTBRITISHMERCHANTMENINCONSTANTANXIETYNOTUNTILTHEFRENCHFLEETWASTHROWNINTOTHESCALEWERETHEBRITISHCOMPELLEDTORECKONSERIOUSLYWITHTHEENEMYONTHESEAANDMAKEPLANSBASEDUPONTHEPOSSIBILITIESOFAMARITIMEDISASTERCOMMANDINGOFFICERSONTHESCOREOFMILITARYLEADERSHIPITISDIFFICULTTOCOMPARETHECONTENDINGFORCESINTHEREVOLUTIONARYCONTESTTHEREISNODOUBTTHATALLTHEBRITISHCOMMANDERSWEREMENOFEXPERIENCEINTHEARTOFWARFARESIRWILLIAMHOWEHADSERVEDINAMERICADURINGTHEFRENCHWARANDWASACCOUNTEDANEXCELLENTOFFICERASTRICTDISCIPLINARIANANDAGALLANTGENTLEMANNEVERTHELESSHELOVEDEASESOCIETYANDGOODLIVINGANDHISEXPULSIONFROMBOSTONHISFAILURETOOVERWHELMWASHINGTONBYSALLIESFROMHISCOMFORTABLEBASESATNEWYORKANDPHILADELPHIADESTROYEDEVERYSHREDOFHISMILITARYREPUTATIONJOHNBURGOYNETOWHOMWASGIVENTHETASKOFPENETRATINGNEWYORKFROMCANADAHADLIKEWISESEENSERVICEINTHEFRENCHWARBOTHINAMERICAANDEUROPEHEHADHOWEVERATOUCHOFTHETHEATRICALINHISNATUREANDAFTERTHECOLLAPSEOFHISPLANSANDTHESURRENDEROFHISARMYINHEDEVOTEDHISTIMEMAINLYTOLIGHTLITERATURESIRHENRYCLINTONWHODIRECTEDTHEMOVEMENTWHICHENDEDINTHECAPTUREOFCHARLESTONINHADLEARNEDHISTRADEONTHECONTINENTANDWASREGARDEDASAMANOFDISCRETIONANDUNDERSTANDINGINMILITARYMATTERSLORDCORNWALLISWHOSEACHIEVEMENTSATCAMDENANDGUILFORDWEREBLOTTEDOUTBYHISSURRENDERATYORKTOWNHADSEENSERVICEINTHESEVENYEARSWARANDHADUNDOUBTEDTALENTSWHICHHEAFTERWARDDISPLAYEDWITHGREATCREDITTOHIMSELFININDIATHOUGHNONEOFTHEMPERHAPSWEREMENOFFIRSTRATEABILITYTHEYALLHADTRAININGANDEXPERIENCETOGUIDETHEMILLUSTRATIONGEORGEWASHINGTONTHEAMERICANSHADAHOSTINWASHINGTONHIMSELFHEHADLONGBEENINTERESTEDINMILITARYSTRATEGYANDHADTESTEDHISCOOLNESSUNDERFIREDURINGTHEFIRSTCLASHESWITHTHEFRENCHNEARLYTWENTYYEARSBEFOREHEHADNODOUBTSABOUTTHEJUSTICEOFHISCAUSESUCHASPLAGUEDSOMEOFTHEBRITISHGENERALSHEWASASTERNBUTREASONABLEDISCIPLINARIANHEWASRESERVEDANDPATIENTLITTLEGIVENTOEXALTATIONATSUCCESSORDEPRESSIONATREVERSESINTHEDARKHOUROFTHEREVOLUTIONWHATHELDTHEPATRIOTFORCESTOGETHERASKSBEVERIDGEINHISLIFEOFJOHNMARSHALLTHENHEANSWERSGEORGEWASHINGTONANDHEALONEHADHEDIEDORBEENSERIOUSLYDISABLEDTHEREVOLUTIONWOULDHAVEENDEDWASHINGTONWASTHESOULOFTHEAMERICANCAUSEWASHINGTONWASTHEGOVERNMENTWASHINGTONWASTHEREVOLUTIONTHEWEAKNESSOFCONGRESSINFURNISHINGMENANDSUPPLIESTHEINDOLENCEOFCIVILIANSWHOLIVEDATEASEWHILETHEARMYSTARVEDTHEINTRIGUESOFARMYOFFICERSAGAINSTHIMSUCHASTHECONWAYCABALTHECOWARDICEOFLEEATMONMOUTHEVENTHETREASONOFBENEDICTARNOLDWHILETHEYSTIRREDDEEPEMOTIONSINHISBREASTANDAROUSEDHIMTOMAKEPASSIONATEPLEASTOHISCOUNTRYMENDIDNOTSHAKEHISIRONWILLORHISFIRMDETERMINATIONTOSEETHEWARTHROUGHTOTHEBITTERENDTHEWEIGHTOFWASHINGTONSMORALFORCEWASIMMEASURABLE')
           ]
    
    print("Generating vigenere")
    for keyLen in range(2,15):
        for x in range(count):
            key = random.sample(list(string.ascii_uppercase), keyLen)
            data.append(encryptors.vigenere.encrypt_vigenere(random.choice(pts), key))
            labels.append(config["vigenere"])
    print("Generating substitution")

    key = list(string.ascii_uppercase)
    for x in range(count):
        random.shuffle(key)
        data.append(encryptors.substitution.encrypt_substitution(random.choice(pts), key))
        labels.append(config["substitution"])

    print("Generating transposition")
    for keyLen in range(2,15):
        key = list(range(keyLen))
        for x in range(count):
            random.shuffle(key)
            data.append(encryptors.transposition.encrypt_transposition(random.choice(pts), key))
            labels.append(config["transposition"])
              
    print("Generating 2x2 Hill")
    for x in range(count):
        key = random.sample(list(string.ascii_uppercase), 4)
        data.append(encryptors.hill.encrypt_hill_2(random.choice(pts), key))
        labels.append(config["hill 2x2"])

    print("Generating 3x3 Hill")
    for x in range(count):
        key = random.sample(list(string.ascii_uppercase), 9)
        data.append(encryptors.hill.encrypt_hill_3(random.choice(pts), key))
        labels.append(config["hill 3x3"])
        
    print("Generating twosquare")
    key1 = random.sample(list(string.ascii_uppercase), 5)
    key2 = random.sample(list(string.ascii_uppercase), 5)

    for x in range(count):
        random.shuffle(key1)
        random.shuffle(key2)

        data.append(encryptors.twosquare.encrypt_two_square(random.choice(pts), key1, key2, 0))
        labels.append(config["twosquare"])
        data.append(encryptors.twosquare.encrypt_two_square(random.choice(pts), key1, key2, 1))
        labels.append(config["twosquare"])

    print("Generating statistics")

    data = np.array(list(map(lambda x: [func(x) for func in statistics.stats_funcs], data)))
    labels = np.asarray(labels)


    data.dump(data_file)
    labels.dump(label_file)

    return
        


    
